{% extends "plantilla.html" %}
{% load static %}

{% block title %}
    Detalle de Caso - Asesor | SIAPE
{% endblock %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'CSS/dashboard.css' %}">
{% endblock %}

{% block content %}
<div class="main-content">

    <nav class="dashboard-nav">
        <a href="{% url 'dashboard_asesor' %}" class="nav-item">
            <i class="fas fa-home"></i>
            Panel Principal
        </a>
        <a href="{% url 'casos_asesor' %}" class="nav-item active"> <i class="fas fa-folder-open"></i>
            Casos
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-tachometer-alt"></i>
            Panel de Control
        </a>
        
        <a href="#" class="nav-item" style="margin-left: auto;">
            <i class="fas fa-cog"></i>
            Configuración
        </a>
        <a href="#" class="nav-item">
            <i class="fas fa-user-circle"></i>
        </a>
    </nav>

    <div class="detalle-grid-container">

        <div class="detalle-card" id="card-info-estudiante">
            <h3 class="detalle-titulo">NOMBRE DEL ESTUDIANTE</h3>
            <p>{{ estudiante.nombres }} {{ estudiante.apellidos }}</p>
            <h3 class="detalle-titulo">RUT:</h3>
            <p>{{ estudiante.rut }}</p>
            <h3 class="detalle-titulo">CONDICIÓN/ES:</h3>
            <p>
                {% for ajuste in ajustes %}
                    {{ ajuste.ajuste_razonable.categorias_ajustes.nombre_categoria }}{% if not forloop.last %}, {% endif %}
                {% empty %}
                    No especificadas
                {% endfor %}
            </p>
        </div>

        <div class="detalle-card" id="card-estado-caso">
            {% if solicitud.estado == 'aprobado' %}
                <div class="detalle-status status-aprobado">
                    {{ solicitud.get_estado_display|upper }}
                </div>
            {% elif solicitud.estado == 'rechazado' %}
                <div class="detalle-status status-rechazado">
                    {{ solicitud.get_estado_display|upper }}
                </div>
            {% else %}
                <div class="detalle-status status-en_proceso">
                    {{ solicitud.get_estado_display|upper }}
                </div>
            {% endif %}
        </div>
        
        <div class="detalle-card" id="card-docs-estado">
            <h3 class="detalle-titulo">ESTADO DEL CASO</h3>
            
            <div class="doc-status-box">
                <span>DOCUMENTOS DE IDENTIFICACIÓN</span>
                {% if evidencias %}
                    <strong class_A"status-tag status-identificado">ESTUDIANTE IDENTIFICADO</strong>
                {% else %}
                    <strong class="status-tag status-pendiente">PENDIENTE</strong>
                {% endif %}
            </div>
            
            <div class="doc-status-box">
                <span>SITUACIÓN ACADEMICA</span>
                <strong class="status-tag status-en-proceso">DOCUMENTOS EN PROCESO</strong>
            </div>
        </div>

        <div class="detalle-card" id="card-soluciones">
            <h3 class="detalle-titulo">SOLUCIONES:</h3>
            <ul>
                {% for ajuste in ajustes %}
                    <li>{{ ajuste.ajuste_razonable.descripcion }}</li>
                {% empty %}
                    <li>Aún no se han asignado soluciones.</li>
                {% endfor %}
            </ul>
        </div>

        <div class="detalle-card" id="card-asunto">
            <h3 class="detalle-titulo">ASUNTO PRINCIPAL:</h3>
            <p>{{ solicitud.descripcion|default:solicitud.asunto }}</p>
        </div>

        <div class="detalle-card" id="card-calendario">
            <div class="calendario-header">
                <strong>Noviembre 2025</strong>
            </div>
            <div class="calendario-grid">
                <div class="cal-day-header">L</div>
                <div class="cal-day-header">M</div>
                <div class="cal-day-header">X</div>
                <div class="cal-day-header">J</div>
                <div class="cal-day-header">V</div>
                <div class="cal-day-header">S</div>
                <div class="cal-day-header">D</div>
                
                <div class="cal-day other-month">27</div>
                <div class="cal-day other-month">28</div>
                <div class="cal-day other-month">29</div>
                <div class="cal-day other-month">30</div>
                <div class="cal-day other-month">31</div>
                <div class="cal-day">1</div>
                <div class="cal-day">2</div>
                
                <div class="cal-day">3</div>
                <div class="cal-day">4</div>
                <div class="cal-day">5</div>
                <div class="cal-day">6</div>
                <div class="cal-day day-entrevista">7</div>
                <div class="cal-day">8</div>
                <div class="cal-day">9</div>

                <div class="cal-day">10</div>
                <div class="cal-day day-interrupcion">11</div>
                <div class="cal-day">12</div>
                <div class="cal-day day-habil">13</div>
                <div class="cal-day">14</div>
                <div class="cal-day">15</div>
                <div class="cal-day">16</div>
                
                <div class="cal-day">17</div>
                <div class="cal-day">18</div>
                <div class="cal-day">19</div>
                <div class="cal-day">20</div>
                <div class="cal-day">21</div>
                <div class="cal-day">22</div>
                <div class="cal-day">23</div>
                
                <div class="cal-day">24</div>
                <div class="cal-day">25</div>
                <div class="cal-day">26</div>
                <div class="cal-day">27</div>
                <div class="cal-day">28</div>
                <div class="cal-day">29</div>
                <div class="cal-day">30</div>
            </div>
            <div class="calendario-leyenda">
                <div><span class="dot dot-entrevista"></span> Fecha entrevista</div>
                <div><span class="dot dot-habil"></span> Fecha hábil</div>
                <div><span class="dot dot-interrupcion"></span> Interrupción</div>
            </div>
        </div>

        <div id="card-volver">
            <a href="{% url 'casos_asesor' %}" class="btn-volver">
                <i class="fas fa-chevron-left"></i> Volver
            </a>
        </div>

    </div>
</div>
{% endblock %}